"use strict";const e=require("../../../common/vendor.js"),r=require("../../../common/assets.js"),t={components:{NavBar:()=>"../../Nav/NavBar.js"},data:()=>({isWideScreen:!0,logoSrc:"/static/zero_logo.png",activeTab:"orders",items:[],search:"",searchedOrders:[],currentPage:1,pageSize:10,totalPages:1,pagedOrders:[],showModal:!1,selectedOrder:null}),mounted(){this.checkScreen(),window.addEventListener("resize",this.checkScreen),this.fetchOrders()},beforeDestroy(){window.removeEventListener("resize",this.checkScreen)},methods:{home(){e.index.switchTab({url:"/pages/tabbar/Home/home"})},checkScreen(){"undefined"!=typeof window?this.isWideScreen=window.innerWidth>=768:e.index.getSystemInfo({success:e=>{const r="ios"===e.platform||"android"===e.platform;this.isWideScreen=!r}})},handleClick(r){e.index.showToast({title:`Clicked on ${r}`,icon:"none"})},changeTab(r){this.activeTab=r,"home"===r?e.index.switchTab({url:"/pages/tabbar/Home/home"}):"wallet"===r?e.index.switchTab({url:"/pages/tabbar/Wallet/wallet"}):"orders"===r&&e.index.switchTab({url:"/pages/tabbar/Order/order"})},fetchOrders(){e.index.request({url:"http://localhost:8000/orders.php",method:"GET",success:e=>{200===e.statusCode&&Array.isArray(e.data)?(this.items=e.data,this.searchedOrders=[...this.items],this.totalPages=Math.ceil(this.searchedOrders.length/this.pageSize),this.updatePagedOrders()):console.error("Invalid response or failed to fetch")},fail:e=>{console.error("API Error:",e)}})},applyFilters(){this.searchedOrders=this.search.trim()?this.items.filter((e=>e.order_id.toString().includes(this.search))):[...this.items],this.totalPages=Math.ceil(this.searchedOrders.length/this.pageSize),this.currentPage=1,this.updatePagedOrders()},updatePagedOrders(){const e=(this.currentPage-1)*this.pageSize;this.pagedOrders=this.searchedOrders.slice(e,e+this.pageSize)},changePage(e){e<1||e>this.totalPages||(this.currentPage=e,this.updatePagedOrders())},openModal(e){this.selectedOrder=e,this.showModal=!0},closeModal(){this.showModal=!1,this.selectedOrder=null},changeTab(r){e.index.switchTab({url:`/pages/tabbar/tabbar-${"home"===r?"1":"wallet"===r?"2":"4"}/tabbar-${"home"===r?"1":"wallet"===r?"2":"4"}`})}}};if(!Array){e.resolveComponent("NavBar")()}const a=e._export_sfc(t,[["render",function(t,a,s,o,d,i){return e.e({a:d.isWideScreen},d.isWideScreen?{b:e.o((e=>i.home())),c:r._imports_0,d:"home"===d.activeTab?1:"",e:e.o((e=>i.changeTab("home"))),f:"wallet"===d.activeTab?1:"",g:e.o((e=>i.changeTab("wallet"))),h:"orders"===d.activeTab?1:"",i:e.o((e=>i.changeTab("orders")))}:{j:d.logoSrc,k:e.o(((...e)=>t.handleError&&t.handleError(...e)))},{l:!d.isWideScreen},d.isWideScreen?{}:{m:e.o(i.changeTab),n:e.p({activeTab:d.activeTab})},{o:e.o([e=>d.search=e.detail.value,(...e)=>i.applyFilters&&i.applyFilters(...e)]),p:d.search,q:e.f(d.pagedOrders,((r,t,a)=>({a:e.t(r.order_id),b:e.t(r.order_date),c:e.t(r.customer||"-"),d:e.t(r.status||"Unknown Status"),e:r.order_id,f:e.o((e=>i.openModal(r)))}))),r:e.o((e=>i.changePage(d.currentPage-1))),s:1===d.currentPage,t:e.t(d.currentPage),v:e.t(d.totalPages),w:e.o((e=>i.changePage(d.currentPage+1))),x:d.currentPage===d.totalPages,y:d.showModal},d.showModal?{z:e.o(((...e)=>i.closeModal&&i.closeModal(...e))),A:e.t(d.selectedOrder.order_id),B:e.t(d.selectedOrder.order_date),C:e.t(d.selectedOrder.customer||"-"),D:e.f(d.selectedOrder.items,((r,t,a)=>({a:e.t(r.order_item_name),b:e.t(r.item_price),c:t}))),E:e.t(d.selectedOrder.status||"N/A"),F:e.t(d.selectedOrder.total_amount),G:e.t(d.selectedOrder.commission||"N/A"),H:e.o(((...e)=>i.closeModal&&i.closeModal(...e))),I:e.o((()=>{})),J:e.o(((...e)=>i.closeModal&&i.closeModal(...e)))}:{},{K:d.isWideScreen?1:"",L:!d.isWideScreen},d.isWideScreen?{}:{M:e.o(i.changeTab),N:e.p({activeTab:d.activeTab})})}],["__scopeId","data-v-163cd60d"]]);qa.createPage(a);
